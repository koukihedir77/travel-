/*@license For license information please refer to shared-ui-shopping-search-criteria-providers.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[1602],{95263:function(e,r,t){t.d(r,{FQ:function(){return ve},IJ:function(){return or},KL:function(){return ae},Kk:function(){return _e},Kp:function(){return Be},NZ:function(){return ur},PR:function(){return O},rO:function(){return ir}});var n=t(38972),a=t(96170),i=t(38109),o=t(33821),u=t(85221),l=t(55025),c=t(23109);function s(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function d(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function p(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){d(e,r,t[r])}))}return e}function f(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):function(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})),e}function g(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,a,i=[],o=!0,u=!1;try{for(t=t.call(e);!(o=(n=t.next()).done)&&(i.push(n.value),!r||i.length!==r);o=!0);}catch(l){u=!0,a=l}finally{try{o||null==t.return||t.return()}finally{if(u)throw a}}return i}}(e,r)||m(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}function h(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,r){if(e){if("string"==typeof e)return s(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(e,r):void 0}}function E(){var e=v(["\n  query PropertySearchQuery(\n    $context: ContextInput!\n    $destination: DestinationInput!\n    $rooms: [RoomInput!]\n    $dateRange: PropertyDateRangeInput\n    $sort: PropertySort\n    $filters: PropertySearchFiltersInput\n    $marketing: PropertyMarketingInfoInput\n    $propertyShopOptions: PropertyShopOptionsInput\n    $searchPagination: PaginationInput\n    $searchIntent: SearchIntentInput\n    $shoppingContext: ShoppingContextInput\n    $criteria: PropertySearchCriteriaInput\n    $productShoppingCriteriaInput: ProductShoppingCriteriaInput\n  ) {\n    propertySearch(\n      context: $context\n      destination: $destination\n      rooms: $rooms\n      dateRange: $dateRange\n      sort: $sort\n      filters: $filters\n      marketing: $marketing\n      propertyShopOptions: $propertyShopOptions\n      searchPagination: $searchPagination\n      searchIntent: $searchIntent\n      shoppingContext: $shoppingContext\n      criteria: $criteria\n      productShoppingCriteriaInput: $productShoppingCriteriaInput\n      returnPropertyType: false\n    ) {\n      searchCriteria {\n        searchId\n      }\n    }\n  }\n"]);return E=function(){return e},e}function _(){var e=v(["\n  query ProductNavigationBarQuery($context: ContextInput!, $productIdentifier: ProductIdentifierInput!) {\n    productNavigationBar(context: $context, productIdentifier: $productIdentifier) {\n      tabs {\n        text\n      }\n    }\n  }\n"]);return _=function(){return e},e}function I(){var e=v(["\n  query FlightSearchQuery(\n    $context: ContextInput!\n    $flightsSearchContext: FlightsSearchContextInput\n    $journeyCriteria: [FlightsJourneyCriteriaInput!]!\n    $searchFilterValuesList: [FlightsSearchFilterValuesInput!]\n    $searchPreferences: FlightsSearchPreferencesInput\n    $sortOption: FlightsSortOptionTypeInput\n    $travelerDetails: [FlightsTravelerDetailsInput!]\n  ) {\n    flightsSearch(\n      context: $context\n      flightsSearchContext: $flightsSearchContext\n      journeyCriteria: $journeyCriteria\n      searchPreferences: $searchPreferences\n      searchFilterValuesList: $searchFilterValuesList\n      travelerDetails: $travelerDetails\n      sortOption: $sortOption\n    ) {\n      gaiaId\n    }\n  }\n"]);return I=function(){return e},e}var Y=n.createContext(null),T=n.createContext(null),O=function(e){return e[e.READ_PARAMS_FROM_URL=0]="READ_PARAMS_FROM_URL",e[e.MULTI_SELECT_CLEAR_ALL=1]="MULTI_SELECT_CLEAR_ALL",e[e.MULTI_SELECT_CLOSE=2]="MULTI_SELECT_CLOSE",e[e.SORT_AND_FILTER_UPDATE=3]="SORT_AND_FILTER_UPDATE",e[e.SEARCH_FORM_UPDATE=4]="SEARCH_FORM_UPDATE",e[e.REMOVE_FILTER_PILL=5]="REMOVE_FILTER_PILL",e[e.REMOVE_ALL_FILTERS=6]="REMOVE_ALL_FILTERS",e}(O||{}),y=[{locale:"en_AU",format:"dd-MM-YYYY"},{locale:"en_CA",format:"dd-MM-YYYY"},{locale:"en_GB",format:"dd-MM-YYYY"},{locale:"en_IE",format:"dd-MM-YYYY"},{locale:"en_MY",format:"dd-MM-YYYY"},{locale:"en_SG",format:"dd-MM-YYYY"},{locale:"en_US",format:"MM-dd-YYYY",siteid:1},{locale:"en_US",format:"dd-MM-YYYY",siteid:12},{locale:"en_US",format:"YYYY-MM-dd",siteid:16},{locale:"en_US",format:"YYYY-MM-dd",siteid:28},{locale:"en_US",format:"YYYY-MM-dd",siteid:62},{locale:"en_US",format:"dd-MM-YYYY",siteid:69},{locale:"es_AR",format:"dd-MM-YYYY"},{locale:"es_ES",format:"dd-MM-YYYY"},{locale:"es_MX",format:"MM-dd-YYYY",siteid:1},{locale:"es_MX",format:"dd-MM-YYYY",siteid:12},{locale:"es_MX",format:"dd-MM-YYYY",siteid:4403},{locale:"es_MX",format:"dd-MM-YYYY",siteid:4404},{locale:"es_MX",format:"dd-MM-YYYY",siteid:4405},{locale:"es_MX",format:"dd-MM-YYYY",siteid:4407},{locale:"da_DK",format:"dd-MM-YYYY"},{locale:"de_AT",format:"dd-MM-YYYY"},{locale:"de_DE",format:"dd-MM-YYYY"},{locale:"de_CH",format:"dd-MM-YYYY"},{locale:"fi_FI",format:"dd-MM-YYYY"},{locale:"fr_CH",format:"dd-MM-YYYY"},{locale:"fr_BE",format:"dd-MM-YYYY"},{locale:"fr_CA",format:"dd-MM-YYYY"},{locale:"fr_FR",format:"dd-MM-YYYY"},{locale:"nl_BE",format:"dd-MM-YYYY"},{locale:"nl_NL",format:"dd-MM-YYYY"},{locale:"nb_NO",format:"dd-MM-YYYY"},{locale:"pt_BR",format:"dd-MM-YYYY"},{locale:"zh_HK",format:"dd-MM-YYYY"},{locale:"vi_VN",format:"dd-MM-YYYY"},{locale:"it_IT",format:"dd-MM-YYYY"},{locale:"ms_MY",format:"dd-MM-YYYY"},{locale:"id_ID",format:"dd-MM-YYYY"},{locale:"th_TH",format:"dd-MM-YYYY"},{locale:"ca_ES",format:"dd-MM-YYYY"},{locale:"en_PH",format:"MM-dd-YYYY"},{locale:"en_HK",format:"YYYY-MM-dd"},{locale:"ja_JP",format:"YYYY-MM-dd"},{locale:"ko_KR",format:"YYYY-MM-dd"},{locale:"sv_SE",format:"YYYY-MM-dd"},{locale:"zh_CN",format:"YYYY-MM-dd"},{locale:"zh_TW",format:"YYYY-MM-dd"}],R=function(e){return{day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}},S=function(e){var r=g(e.split("-").map((function(e){return Number.parseInt(e,10)})),3),t=r[0],n=r[1];return{day:r[2],month:n,year:t}},C=function(e,r,t){var n,a,i=e.replace("TANYT","").split(/[/.-]/).map((function(e){return parseInt(e,10)})),o="MM-dd-YYYY",u=y.filter((function(e){return e.locale===r}));if(u.length>1){var l=u.filter((function(e){return e.siteid===t}));l.length>0&&(o=l[0].format)}else 1===u.length&&(o=u[0].format);return n=i,"dd-MM-YYYY"===(a=o)?{day:n[0],month:n[1],year:n[2]}:"MM-dd-YYYY"===a?{day:n[1],month:n[0],year:n[2]}:{day:n[2],month:n[1],year:n[0]}},M=function(e){var r,t,n,a=e;switch(3!==a.length&&5!==a.length||(a="0".concat(a)),a.length){case 4:r=parseInt(a.substring(0,2),10),t=parseInt(a.substring(2,4),10);break;case 6:if(r=parseInt(a.substring(0,2),10),t=parseInt(a.substring(2,4),10),"AM"!==(n=a.substring(4,6).toUpperCase())&&"PM"!==n)throw new Error("Failed to parse time value: ".concat(e));break;default:throw new Error("Failed to parse time value: ".concat(e))}if(Number.isNaN(r)||Number.isNaN(t))throw new Error("Failed to parse time value: ".concat(e));if(12===r&&"AM"===n&&(r=0),12!==r&&"PM"===n&&(r+=12),r<0||r>23||t<0||t>59)throw new Error("Failed to parse time value: ".concat(e));return"".concat(r,":").concat(t)},P=function(e,r,t,n,a,i){var o=function(e,r,t){var n;try{n=r.parseLocalDateString(e,t?{raw:t}:{})}catch(a){try{n=r.parseLocalDateString(e,{raw:"yyyy-MM-dd"})}catch(i){return null}}return r.formatDate(n,{raw:"yyyy-MM-dd"})||null}(null!=e?e:n,t,e?i:""),u=S(null!=o?o:n),l=g(function(e,r){var t=g((null!=e?e:r).split(":").map((function(e){return parseInt(e,10)})),2),n=t[0],a=t[1];return[Number.isNaN(n)?10:n,void 0===a||Number.isNaN(a)?30:a]}(r,a),2),c=l[0],s=l[1];return f(p({},u),{hour:c,minute:s,second:0})},A=function(e,r){return e?r.formatDate(new Date(e.year,e.month-1,e.day),{raw:"yyyy-MM-dd"}):null},L=function(e){return e?"".concat(e.hour,":").concat(e.minute):null},N=function(e,r,t){r?t.set(e,r):t.delete(e)},D="10:30",b={SEARCH_TERM:"locn",REGION:"dpln",EXACT_LOCATION:"exlocn",LATITUDE:"olat",LONGITUDE:"olon"},U={SEARCH_TERM:"loc2",REGION:"drid1",EXACT_LOCATION:"exloc2",LATITUDE:"dlat",LONGITUDE:"dlon"},w={DATE:"date1",TIME:"time1"},x={DATE:"date2",TIME:"time2"},F=function(e,r,t,n,a){var i=!r&&n&&a?{latitude:Number(n),longitude:Number(a)}:void 0;return{searchTerm:e||void 0,regionId:null!=r?r:void 0,coordinates:i,isExactLocationSearch:Boolean(i)||Boolean(t)}},H=function(e){var r=new Date;return r.setDate(r.getDate()+e),r.toISOString().split("T")[0]},G=function(e,r,t){var n=function(e){var r=e.get(b.SEARCH_TERM),t=e.get(b.REGION),n=e.get(b.EXACT_LOCATION),a=e.get(b.LATITUDE),i=e.get(b.LONGITUDE);return F(r,t,n,a,i)}(e),a=function(e){var r=e.get(U.SEARCH_TERM),t=e.get(U.REGION),n=e.get(U.EXACT_LOCATION),a=e.get(U.LATITUDE),i=e.get(U.LONGITUDE),o=F(r,t,n,a,i);return o.regionId||o.searchTerm||o.coordinates?o:null}(e),i=function(e,r,t){var n=e.get(w.DATE),a=e.get(w.TIME),i=a&&!a.includes(":")?M(a):a;return P(n,i,r,H(14),D,t)}(e,r,t),o=function(e,r,t){var n=e.get(x.DATE),a=e.get(x.TIME),i=a&&!a.includes(":")?M(a):a;return P(n,i,r,H(15),D,t)}(e,r,t);return{pickUpLocation:n,pickUpDateTime:i,dropOffLocation:a,dropOffDateTime:o}},k=function(e){var r=[],t="aarpcr";return"on"===e.get(t)&&r.push({id:t,value:!0}),r},$=function(e){var r=["orid","oloc","rdus","piid","totalprice","age","rfrr","useRewards"],t=h(e.keys()).filter((function(e){return e.startsWith("sel")||r.includes(e)}));return h(new Set(t))},B=function(e){var r=function(e){if(0===h(e.keys()).length)return[];var r=[];return $(e).forEach((function(t){var n=e.get(t);n&&(n.includes("[")?JSON.parse(n).forEach((function(e){r.push({id:t,value:e})})):"piid"===t?r.push({id:"carOfferToken",value:n}):"useRewards"===t?r.push({id:t,value:"true"===n?"ApplyRewardsPoints":"DoNotApplyRewardsPoints"}):r.push({id:t,value:n}))})),r}(e),t=function(e){var r=[],t=e.get("cdnu"),n=e.get("cpcd"),a=e.get("rtcd"),i=e.get("odcd");return t&&r.push({id:"corporateDiscountCode",value:t}),n&&r.push({id:"promoCode",value:n}),a&&r.push({id:"rateCode",value:a}),i&&r.push({id:"loyaltyProgramCode",value:i}),r}(e);return h(r).concat(h(t))},j=function(e,r,t){return{primarySearchCriteria:{car:G(e,r,t)},secondaryCriteria:{booleans:k(e),selections:B(e)}}},V=function(e,r,t){var n;return h(((null===(n=t.secondaryCriteria)||void 0===n?void 0:n.selections)||[]).filter((function(t){return t.id!==e||t.id===e&&t.value!==r})))},W=function(e,r,t){var n=e.name,a=e.value,i=r.target,o=i.type,u=i.checked;switch(o){case"checkbox":var l=u?function(e,r,t){var n,a=(null===(n=t.secondaryCriteria)||void 0===n?void 0:n.selections)||[];return a.some((function(t){return t.id===e&&t.value===r}))?h(a):h(a).concat([{id:e,value:r}])}(n,a,t):V(n,a,t);return f(p({},t),{secondaryCriteria:f(p({},t.secondaryCriteria),{selections:l})});case"radio":case"select-one":var c=function(e,r,t){var n,a=((null===(n=t.secondaryCriteria)||void 0===n?void 0:n.selections)||[]).filter((function(r){return r.id!==e}));return r&&a.push({id:e,value:r}),h(a)}(n,a,t);return f(p({},t),{secondaryCriteria:f(p({},t.secondaryCriteria),{selections:c})});default:return t}},K=function(e,r,t){var n=t.getAll(e);return n.includes(r)&&(t.delete(e),n.forEach((function(n){n!==r&&t.append(e,n)}))),t.toString()},X=function(e){var r=(0,o.TH)(),t=(0,o.s0)(),a=(0,u.useLocalization)(),i=g((0,n.useState)(1),2),l=i[0],c=i[1];return n.useReducer((function(n,i){var o=new URLSearchParams(r.search);switch(i.type){case 0:return j(i.urlSearchParams,a,e);case 3:var u=i.field,s=i.event,d=function(e,r,t){var n=e.name,a=e.value,i=r.target,o=i.type,u=i.checked;switch(o){case"checkbox":return u?function(e,r,t){return t.getAll(e).includes(r)||t.append(e,r),t.toString()}(n,a,t):K(n,a,t);case"radio":case"select-one":return function(e,r,t){return r?t.set(e,r):t.delete(e),t.toString()}(n,a,t);default:return t.toString()}}(u,s,o);return t(f(p({},r),{search:d})),W(u,s,n);case 4:var v=i.updatedPrimarySearchCriteria,m=function(e,r,t){var n,a,i,o,u,l,c,s,d,p;t.delete("pwaDialog");var f=null==e?void 0:e.pickUpLocation;N(b.SEARCH_TERM,null==f?void 0:f.searchTerm,t),N(b.EXACT_LOCATION,null==f||null===(n=f.isExactLocationSearch)||void 0===n?void 0:n.toString(),t),N(b.REGION,null==f?void 0:f.regionId,t),N(b.LATITUDE,null==f||null===(i=f.coordinates)||void 0===i||null===(a=i.latitude)||void 0===a?void 0:a.toString(),t),N(b.LONGITUDE,null==f||null===(u=f.coordinates)||void 0===u||null===(o=u.longitude)||void 0===o?void 0:o.toString(),t);var g=null==e?void 0:e.pickUpDateTime;N(w.DATE,A(g,r),t),N(w.TIME,L(g),t);var v=null==e?void 0:e.dropOffLocation;N(U.SEARCH_TERM,null==v?void 0:v.searchTerm,t),N(U.EXACT_LOCATION,null==v||null===(l=v.isExactLocationSearch)||void 0===l?void 0:l.toString(),t),N(U.REGION,null==v?void 0:v.regionId,t),N(U.LATITUDE,null==v||null===(s=v.coordinates)||void 0===s||null===(c=s.latitude)||void 0===c?void 0:c.toString(),t),N(U.LONGITUDE,null==v||null===(p=v.coordinates)||void 0===p||null===(d=p.longitude)||void 0===d?void 0:d.toString(),t);var h=null==e?void 0:e.dropOffDateTime;return N(x.DATE,A(h,r),t),N(x.TIME,L(h),t),t.toString()}(v.car,a,new URLSearchParams);t(f(p({},r),{search:m})),c(l+1);var E={id:"searchFormCount",value:l.toString()};return{primarySearchCriteria:v,secondaryCriteria:f(p({},{booleans:[],selections:[]}),{selections:[E]})};case 5:var _=g(i.filterId,1)[0],I=void 0===_?{id:"",value:""}:_,Y=I.id,T=I.value,O=K(Y,T,o);t(f(p({},r),{search:O}));var y=V(Y,T,n);return f(p({},n),{secondaryCriteria:f(p({},n.secondaryCriteria),{selections:y})});case 6:var R=p({},n),S=function(e){if(0===h(e.keys()).length)return[];var r=[];return $(e).forEach((function(t){var n=e.getAll(t);n&&n.forEach((function(e){r.push({id:t,value:e})}))})),r}(o);return S.forEach((function(e){var n=e.id,a=e.value,i=K(n,a,new URLSearchParams(r.search));t(f(p({},r),{search:i}));var o=V(n,a,R);R=f(p({},R),{secondaryCriteria:f(p({},R.secondaryCriteria),{selections:o})})})),R;default:return n}}),j(new URLSearchParams(r.search),a,e))},q=n.createContext(null),Q=n.createContext(null),z=n.createContext(null),J=function(e){var r=e.children,t=n.useContext(Y),a=function(){var e=n.useContext(T);if(!e)throw new Error("useCarsCriteriaDispatch can only be used inside CarsCriteriaProvider");return e}();return n.createElement(q.Provider,{value:t},n.createElement(z.Provider,{value:a},r))};J.displayName="sharedui-CarsCriteriaConsumer";var Z=n.createContext(null),ee=n.createContext(null),re=n.createContext(null),te=function(e){return e.LOWER="LOWER",e.UPPER="UPPER",e}(te||{}),ne=function(e){return e.DAY="DAY",e.MONTH="MONTH",e.WEEK="WEEK",e.WEEKEND="WEEKEND",e}(ne||{}),ae=function(e){return e.SAILING_VARIETIES="sailing-varieties",e.CABIN_EXPERIENCE="cabin-experience",e.DEPARTURE_PORT="departure-port",e.CRUISE_LINE="cruise-line",e.SHIPS="ships",e}(ae||{}),ie=["alaska","bahamas","caribbean","europe","mexico"],oe=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"|",n=[];return h(new Set(e.getAll(r))).reduce((function(e,r){return r.split(t).forEach((function(r){e.push(r)})),e}),n).length?n:null},ue=function(e,r){var t=e.get(r),n=parseInt(t||"",10);return Number.isNaN(n)?null:n},le=function(e){var r,t,n=e.get("earliest-departure-date"),a=e.get("latest-departure-date");return n&&a?{start:S(n),end:S(a)}:(r=new Date,(t=new Date).setDate(r.getDate()+30),{start:R(r),end:R(t)})},ce=function(e){var r=ue(e,"min-length"),t=ue(e,"max-length");return r&&t?{min:r,max:t}:null},se=function(e){var r,t,n=oe(e,"childAges",",");return null!==(t=null==n||null===(r=n.map((function(e){return{age:parseInt(e,10)}})))||void 0===r?void 0:r.filter((function(e){var r=e.age;return Number.isInteger(r)})))&&void 0!==t?t:null},de=function(e,r){return e&&0!==e.length?e.map((function(e){return{id:r,value:e}})):[]},pe=(new Map).set("price|asc","PRICE_LOW_TO_HIGH").set("price|desc","PRICE_HIGH_TO_LOW").set("departure-date|asc","DEPARTURE_EARLY_TO_LATE").set("departure-date|desc","DEPARTURE_LATE_TO_EARLY").set("duration|asc","DURATION_SHORT_TO_LONG").set("duration|desc","DURATION_LONG_TO_SHORT"),fe=function(e){var r;return null!==(r=pe.get("".concat(e.get("sort-by"),"|").concat(e.get("sort-order"))))&&void 0!==r?r:""},ge=function(e){var r;return h(de(oe(e,"sailing-varieties"),"sailing-varieties")).concat(h(de(oe(e,"sailing-token"),"sailing-token")),h(de(oe(e,"cabin-experience"),"cabin-experience")),h(de(oe(e,"departure-port"),"departure-port")),h(de(oe(e,"cruise-line"),"cruise-line")),h(de(oe(e,"ships"),"ships")),[{id:"sort",value:null!==(r=e.get("sort"))&&void 0!==r?r:fe(e)}])},ve=function(e){var r;return{primarySearchCriteria:{cruise:{adultCount:ue(e,"adultCount"),childCount:ue(e,"childCount"),children:se(e),departureDateRange:le(e),destinations:null!==(r=oe(e,"destination"))&&void 0!==r?r:ie,durationRange:ce(e)}},secondaryCriteria:{selections:ge(e)}}},he=function(e,r,t){var n,a=[];return null==r||r.reduce((function(r,t){var n=t.data.value;return n&&r.push({id:e,value:n}),r}),a),h((null==t||null===(n=t.selections)||void 0===n?void 0:n.filter((function(r){return r.id!==e})))||[]).concat(h(a))},me=function(e){var r=e.children,t=(0,o.TH)(),a=g(function(){var e=(0,o.TH)(),r=(0,o.s0)();return n.useReducer((function(t,n){var a=new URLSearchParams(e.search);switch(n.type){case 0:return ve(n.urlSearchParams);case 1:var i,o,u=n.filterId,l=(null===(o=t.secondaryCriteria)||void 0===o||null===(i=o.selections)||void 0===i?void 0:i.filter((function(e){return e.id!==u})))||[];return a.delete(u),r(f(p({},e),{search:a.toString()})),f(p({},t),{secondaryCriteria:f(p({},t.secondaryCriteria),{selections:l})});case 2:var c=n.filterId,s=n.selections,d=f(p({},t.secondaryCriteria),{selections:he(c,s,t.secondaryCriteria)}),g=function(e,r){var t,n=[];return null==r||null===(t=r.selections)||void 0===t||t.reduce((function(r,t){return t.id===e&&r.push(t.value),r}),n),0===n.length?null:n.join("|")}(c,d);return g&&a.set(c,g),r(f(p({},e),{search:a.toString()})),f(p({},t),{secondaryCriteria:d});default:return t}}),ve(new URLSearchParams(e.search)))}(),2),i=a[0],u=a[1];return n.useEffect((function(){u({type:0,urlSearchParams:new URLSearchParams(t.search)})}),[t.search,u]),n.createElement(Z.Provider,{value:i},n.createElement(re.Provider,{value:u},r))};me.displayName="sharedui-CruiseCriteriaProvider";var Ee="10:30",_e=function(e){return e.FILTER_CATEGORIES="filterCategories",e}(_e||{});function Ie(e){if(!e)return null;var r=g(e.split(","),2),t=r[0],n=r[1];return t&&n?{latitude:Number(t),longitude:Number(n)}:null}var Ye=function(){var e=new Date;return e.setDate(e.getDate()+14),e.toISOString().split("T")[0]};function Te(e){return{id:e.hotelId,name:e.hotelName,coordinates:Ie(e.hotelLatLong),type:"PROPERTY"}}function Oe(e){var r=e.airportCode,t=e.location,n=e.airportLatLong,a=e.regionId;return r?{id:r,name:t,coordinates:Ie(n),type:"AIRPORT"}:{id:a,name:t,type:"DESTINATION"}}function ye(e,r,t){var n=Object.fromEntries(e),a=n.direction,i=n.roundTrip,o=n.pickUpDate,u=n.pickUpTime,l=n.dropOffDate,c=n.dropOffTime,s=function(e,r){if("true"===e)return"ROUNDTRIP";switch(r){case"H2A":case"TO_AIRPORT":return"TO_AIRPORT";default:return"FROM_AIRPORT"}}(i,a),d="TO_AIRPORT"===s,p=[],f=function(e){var r=e.adults,t=e.children,n=e.infants,a=[];return r&&a.push({type:"ADULT",count:parseInt(r,10)}),t&&a.push({type:"CHILD",count:parseInt(t,10)}),n&&a.push({type:"INFANT",count:parseInt(n,10)}),a}(n),g={dateTime:P(o,u,r,Ye(),Ee,t),origin:d?Te(n):Oe(n),destination:d?Oe(n):Te(n)};if(p.push(g),"true"===n.roundTrip){var v={dateTime:P(null!=l?l:o,null!=c?c:u,r,Ye(),Ee,t),origin:Te(n),destination:Oe(n)};p.push(v)}return{journeyCriteria:p,shoppingPath:"STANDALONE",travelerDetails:f,dateRange:{},direction:null!=s?s:"FROM_AIRPORT",locations:[]}}var Re=function(e){if(0===h(e.keys()).length)return null;var r,t,n,a=[],i=(r="filter",t=h(e.keys()).filter((function(e){return e.indexOf(r)>-1})),h(new Set(t)));return a.push({id:"sort",value:null!==(n=e.get("sort"))&&void 0!==n?n:""}),i.forEach((function(r){var t=h(new Set(e.getAll(r)));t.length&&t.forEach((function(e){e&&a.push({id:r,value:e})}))})),a},Se=n.createContext([null,null]),Ce=function(e){var r=e.children,t=e.localDateFormat,a=(0,u.useLocalization)(),i=(0,o.TH)(),l=n.useMemo((function(){var e=new URLSearchParams(i.search),r=ye(e,a,t),n=function(e){return{booleans:[{id:"swp",value:"false"!==e.get("swp")}],selections:Re(e)}}(e);return[r,n]}),[i.search,a,t]);return n.createElement(Se.Provider,{value:l},r)};Ce.displayName="sharedui-GroundTransportationCriteriaProvider";var Me=n.createContext(null),Pe=function(e){return e.SORT="sort",e.HOTEL_NAME="hotelName",e.REWARDS="rewards",e.STAR="star",e.GUEST_RATING="guestRating",e.CLEANING_AND_SAFETY="cleaningAndSafetyPractices",e.LODGING="lodging",e.MEAL_PLAN="mealPlan",e.AMENITIES="amenities",e.TRAVELER_TYPE="travelerType",e.PAYMENT_TYPE="paymentType",e.DEALS="deals",e.PROPERTY_STYLE="propertyStyle",e.BEDROOM_FILTER="bedroomFilter",e.NEIGHBORHOOD="neighborhood",e.STAY_TYPE="stayType",e.ACCESSIBILITY="accessibility",e.POI="poi",e.MIN_BEDROOMS="bedroom_count_gt",e.MIN_BATHROOMS="us_bathroom_count_gt",e.PROPERTY_TYPE="property_type_group",e.LOCATION="location_group",e.ACCESSIBILITY_FEATURES="accessibility_features_group",e.BOOKING_OPTIONS="booking_options_group",e.DISCOUNTS_GROUP="discounts_group",e.AMENITIES_FACILITIES="amenities_facilities_group",e.FREE_CANCELLATION_GROUP="free_cancellation_group",e.HOUSE_RULES="house_rules_group",e.NEARBY_ACTIVITIES="nearby_activities_group",e.NEIGHBORHOOD_GROUP="neighborhood_group",e.PREMIER_HOST="premier_host_group",e.PROPERTIES_GOOD="properties_good_for_group",e.PROPERTY_REVIEWS="property_reviews_group",e.ROOMS_SPACES="rooms_spaces_group",e.SAFETY="safety_group",e.VIRTUAL_TOUR_GROUP="virtual_tour_group",e.PRICING_GROUP="pricing_group",e.PROPERTY_NAME="propertyName",e.AVAILABLE_FILTER="availableFilter",e.AGENCY_BUSINESS_MODELS="agencyBusinessModels",e.COMMISSION_TIERS="commissionTiers",e.USE_REWARDS="useRewards",e.BED_TYPE_GROUP="bed_type_group",e.STAY_OPTIONS_GROUP="stay_options_group",e.HOTEL_BRAND="hotel_brand",e.MULTI_NEIGHBORHOOD_GROUP="multi_neighborhood_group",e.SPECIAL_DISCOUNTS_GROUP="special_discounts_group",e.HIGHLY_RATED_FOR_GROUP="highly_rated_for_group",e.AI_SEARCH_QUERY="ai_search_query",e.AVAILABILITY_GROUP="availableFilter",e}(Pe||{}),Ae=function(e){return e.PRICE="price",e.NIGHTLY_PRICE="nightly_price",e.TOTAL_PRICE="total_price",e}(Ae||{}),Le=function(e){var r=e.destination,t=e.regionId,n=e.latLong,a=e.selected,i=e.mapBounds,o=e.group,u=g((null==n?void 0:n.split(",").map((function(e){return parseFloat(e)})))||[null,null],2),l=u[0],c=u[1];return p({regionName:r,regionId:t,coordinates:l&&c?{latitude:l,longitude:c}:null,mapBounds:i},a&&{pinnedPropertyId:a},o&&{propertyIds:o})},Ne=function(e){var r=g(e.split("-"),3),t=r[0],n=r[1],a=r[2];return{year:parseInt(t,10),month:parseInt(n,10),day:parseInt(a,10)}},De=function(e){var r=g(e.split("/"),3),t=r[0],n=r[1],a=r[2];return"".concat(a,"-").concat(t,"-").concat(n)},be=function(e){var r=e.startDate,t=e.endDate;if(!r||!t)return null;var n=/^\d{4}-\d{2}-\d{2}$/,a=/^(0?[1-9]|1[0-2])\/(0?[1-9]|[12][0-9]|3[01])\/\d{4}$/,i=n.test(r)||a.test(r),o=n.test(t)||a.test(t);if(!i||!o)return null;var u=n.test(r)?r:De(r),l=n.test(t)?t:De(t);return{checkInDate:Ne(u),checkOutDate:Ne(l)}},Ue=function(e){var r=e.queryParams,t=[];return Object.values(Ae).forEach((function(e){var n,a,i=r.getAll(e),o=(1===i.length?i[0].split(","):i).filter((function(e){return 0!==e.length})).map(Number).filter((function(e){return!Number.isNaN(e)}));o.length>1&&t.push({id:e,min:(n=Math).min.apply(n,h(o)),max:(a=Math).max.apply(a,h(o))})})),t},we=function(e){var r=e.adults,t=e.children,n=(null==r?void 0:r.split(",").map((function(e){return parseInt(e,10)})))||[],a=(null==t?void 0:t.split(","))||[];return n.map((function(e,r){var t=r+1;return{adults:e,children:a.filter((function(e){return e.startsWith(t.toString())})).map((function(e){return{age:parseInt(e.split("_")[1],10)}}))}})).filter((function(e){return!Number.isNaN(e.adults)}))},xe=function(e){var r=e.queryParams,t=e.paramsToExclude,n=e.isPartnerPointsToggleEnabled;return function(e,r){return e.some((function(e){return e.id===r.id}))?e:h(e).concat([r])}(Object.values(Pe).reduce((function(e,a){!n&&r.has("useRewards")&&r.delete("useRewards");var i=r.getAll(a);if(i.length&&""!==i[0]){var o=i.map((function(e){return(t.includes(a)?[e]:e.split(",")).map((function(e){return n&&"useRewards"===a?{id:a,value:"true"===e?"SHOP_WITH_POINTS":"SHOP_WITHOUT_POINTS"}:{id:a,value:e}}))}));return h(e).concat(h(o))}return h(e)}),[]).flat(),{id:"sort",value:"RECOMMENDED"})},Fe=function(e){var r=function(e){var r=e.getAll("flexibility");return 0===r.length?null:r.reduce((function(e,r){var t=r.split("_");if(t.length>1){var n=parseInt(t[0],10),a=ne[t[1].toUpperCase()],i=3===t.length?{bound:te[t[2].toUpperCase()]}:{};n&&a&&e.push(p({length:n,unit:a},i))}return e}),[])}(e),t=function(e){return e.getAll("searchRange").reduce((function(e,r){var t=r.split("_");return 2===t.length&&e.push({start:Ne(t[0]),end:Ne(t[1])}),e}),[])}(e),n=function(e){return e.getAll("flexibleSearchRequirement").filter((function(e){return e}))}(e),a=p({},(null==r?void 0:r.length)&&{flexibility:r},(null==t?void 0:t.length)&&{searchRange:t},(null==n?void 0:n.length)&&{flexibleSearchRequirement:n});return Object.getOwnPropertyNames(a).length?a:null},He=function(e){var r=e.map((function(e){return e.split(",")})).filter((function(e){var r=g(e,2),t=r[0],n=r[1];return""!==t&&""!==n})).map((function(e){var r=g(e,2),t=r[0],n=r[1];return{latitude:Number(t),longitude:Number(n)}}));return 2===r.length?r:[]},Ge=function(e){var r,t=null==e||null===(r=e.split(","))||void 0===r?void 0:r.filter((function(e){return""!==e}));return(null==t?void 0:t.length)?t:null},ke=[{URL_PARAM_ID:"packageRates",QUERY_BOOLEAN_ID:"showPackageRates"},{URL_PARAM_ID:"vacationRentalsOnly",QUERY_BOOLEAN_ID:"showVacationRentalsOnly"},{URL_PARAM_ID:"dateSelectedByUser",QUERY_BOOLEAN_ID:"isUserSelectedDates"}],$e=function(e){return ke.flatMap((function(r){return"true"===e.get(r.URL_PARAM_ID)?[{id:r.QUERY_BOOLEAN_ID,value:!0}]:[]}))},Be=function(e,r){var t,n=Le({destination:e.get("destination"),regionId:"null"===e.get("regionId")?null:e.get("regionId"),latLong:e.get("latLong"),selected:e.get("selected"),mapBounds:He(e.getAll("mapBounds")),group:Ge(e.get("group"))}),a=be({startDate:e.get("startDate"),endDate:e.get("endDate")}),i=we({adults:e.get("adults"),children:e.get("children")}),o=Ue({queryParams:e}),u=xe({queryParams:e,paramsToExclude:["hotelName","poi"],isPartnerPointsToggleEnabled:r}),l=Fe(e),c=l?{flexSearchCriteria:l}:{},s=$e(e);return{propertySearchCriteriaInput:{primary:p({destination:n,rooms:i,dateRange:(null==l?void 0:l.searchRange)&&0!==(null==l||null===(t=l.searchRange)||void 0===t?void 0:t.length)?null:a},c),secondary:{ranges:o,selections:u,booleans:s}}}},je=function(e){var r=e.children,t=n.useContext(Me);return n.createElement(q.Provider,{value:t},r)};je.displayName="sharedui-LodgingCriteriaConsumer";var Ve=function(e){var r=e.children,t=g(n.useContext(Se),2),a=t[0],i=t[1],o=n.useMemo((function(){return{primarySearchCriteria:{groundTransportation:a},secondaryCriteria:i}}),[a,i]);return n.createElement(q.Provider,{value:o},r)},We=function(e){var r=e.children,t=n.useContext(Z),a=function(){var e=n.useContext(re);if(!e)throw new Error("useCruiseCriteriaDispatch can only be used inside CruiseCriteriaProvider");return e}();return n.createElement(q.Provider,{value:t},n.createElement(z.Provider,{value:a},r))};Ve.displayName="sharedui-GroundTransportationCriteriaConsumer",We.displayName="sharedui-CruiseCriteriaConsumer";(0,a.Ps)(E()),(0,a.Ps)(_());var Ke,Xe,qe,Qe,ze,Je,Ze,er,rr,tr,nr=(d(ze={},i.kv.GroundTransportation,(d(Ke={},"Search",Ce),d(Ke,"Product",n.Fragment),Ke)),d(ze,i.kv.Cruise,(d(Xe={},"Search",me),d(Xe,"Product",(function(e){var r,t,a,i,u,l,c,s=e.children,d=(0,o.TH)(),p=g(n.useState((r=new URLSearchParams(d.search),{id:null!==(t=r.get("sailingToken"))&&void 0!==t?t:"",type:"SAILING_TOKEN",productLine:"CRUISE",travelSearchCriteria:{cruise:{primary:{cabinExperience:null!==(a=r.get("cabinExperience"))&&void 0!==a?a:"",cabinType:null!==(i=r.get("cabinType"))&&void 0!==i?i:"",adultCount:null!==(u=ue(r,"adultCount"))&&void 0!==u?u:0,childCount:null!==(l=ue(r,"childCount"))&&void 0!==l?l:0,children:se(r),sailingToken:null!==(c=r.get("sailingToken"))&&void 0!==c?c:""},secondary:{selections:ge(r)}}}})),1)[0];return n.createElement(ee.Provider,{value:p},s)})),Xe)),d(ze,i.kv.Cars,(d(qe={},"Search",(function(e){var r=e.children,t=e.localDateFormat,a=g(X(t),2),i=a[0],o=a[1];return n.createElement(Y.Provider,{value:i},n.createElement(T.Provider,{value:o},r))})),d(qe,"Product",n.Fragment),qe)),d(ze,i.kv.Lodging,(d(Qe={},"Search",(function(e){var r=e.children,t=(0,l.useExperiment)("ETS_POINTS_TOGGLE").exposure,a=(0,o.TH)(),i=n.useMemo((function(){return e=new URLSearchParams(a.search),r=1===t.bucket,i=Le({destination:e.get("destination"),regionId:"null"===e.get("regionId")?null:e.get("regionId"),latLong:e.get("latLong"),selected:e.get("selected"),mapBounds:He(e.getAll("mapBounds")),group:Ge(e.get("group"))}),o=be({startDate:e.get("startDate"),endDate:e.get("endDate")}),u=we({adults:e.get("adults"),children:e.get("children")}),l=Ue({queryParams:e}),c=xe({queryParams:e,paramsToExclude:["hotelName","poi"],isPartnerPointsToggleEnabled:r}),s=Fe(e),d=s?{flexSearchCriteria:s}:{},f=$e(e),{primarySearchCriteria:{property:p({destination:i,rooms:u,dateRange:(null==s?void 0:s.searchRange)&&0!==(null==s||null===(n=s.searchRange)||void 0===n?void 0:n.length)?null:o},d)},secondaryCriteria:{ranges:l,selections:c,booleans:f}};var e,r,n,i,o,u,l,c,s,d,f}),[a.search,t]);return n.createElement(Me.Provider,{value:i},r)})),d(Qe,"Product",n.Fragment),Qe)),ze),ar=(d(tr={},i.kv.GroundTransportation,(d(Je={},"Search",Ve),d(Je,"Product",n.Fragment),Je)),d(tr,i.kv.Cruise,(d(Ze={},"Search",We),d(Ze,"Product",(function(e){var r=e.children,t=n.useContext(ee);return n.createElement(Q.Provider,{value:t},r)})),Ze)),d(tr,i.kv.Cars,(d(er={},"Search",J),d(er,"Product",n.Fragment),er)),d(tr,i.kv.Lodging,(d(rr={},"Search",je),d(rr,"Product",n.Fragment),rr)),tr),ir=function(e){var r=e.children,t=e.localDateFormat,a=e.criteriaType,o=void 0===a?"Search":a,u=(0,i.Cl)(),l=u?nr[u][o]:n.Fragment,c=u?ar[u][o]:n.Fragment;return n.createElement(l,{localDateFormat:t},n.createElement(c,null,r))};ir.displayName="sharedui-ProductShoppingCriteriaProvider";var or=function(){return n.useContext(q)},ur=function(){var e=n.useContext(z);return e||function(){}},lr=function(e){switch(e){case"oneway":default:return"ONE_WAY";case"roundtrip":return"ROUND_TRIP";case"multi":return"MULTI_DESTINATION"}},cr=function(e,r,t){return e.filter((function(e){return null!==e})).map((function(e){var n,a,i=decodeURIComponent(e).replace("from:","").replace(",to:","|").replace(",departure:","|").split("|"),o=i[2]||"";return{departureDate:C(o,r,t),destination:(null===(n=i[1])||void 0===n?void 0:n.split(",toCode")[0])||"",origin:(null===(a=i[0])||void 0===a?void 0:a.split(",frCode")[0])||""}}))},sr=function(e){var r,t,n=e.split(","),a=[],i=n.find((function(e){return e.includes("adults")}))||"",o=n.find((function(e){return e.includes("children")}))||"",u=n.find((function(e){return e.includes("infantinlap")}))||"N";(i&&a.push({travelerType:"ADULT",count:(r=i.split(":"))[1]?parseInt(r[1],10):1}),o)&&(t=a).push.apply(t,h(function(e,r){var t=[],n=e.split(":");if("0"===(null==n?void 0:n[1]))return[];var a=n[1]?n[1].split("["):"",i=parseInt(a[0],10),o=a[1].replace("]","").split(";").map((function(e){return parseInt(e,10)}))||[],u=o.filter((function(e){return e<=1}));return u.length>0&&(i-=u.length,t.push({count:u.length,travelerType:(null==r?void 0:r.includes("Y"))?"INFANT_IN_LAP":"INFANT_IN_SEAT",ages:u})),i>0&&t.push({count:i,travelerType:"CHILD",ages:o.filter((function(e){return e>1}))}),t}(o,u)));return a},dr=function(e){return e.includes("business")?"BUSINESS":e.includes("premium")||e.includes("premium coach")||e.includes("premium_economy")?"PREMIUM_ECONOMY":e.includes("first")?"FIRST":"COACH"},pr=((0,a.Ps)(I()),(0,n.createContext)(null));(function(e){var r=e.children,t=(0,o.TH)(),a=(0,c.v)().context,i=(0,n.useMemo)((function(){var e,r,n,i,o,u,l,c,s,d,p=new URLSearchParams(t.search);return e=p,r=a.locale,n=a.siteId,i=e.get("trip"),o=e.get("originalBookingId"),u=e.get("journeysContinuationId"),l=e.get("airCreditIntent"),c=e.get("passengers")||"",s=e.get("options")||"",d=[e.get("leg1")||"",e.get("leg2")||"",e.get("leg3")||"",e.get("leg4")||"",e.get("leg5")||""].filter((function(e){return""!==e})),{journeyCriteria:cr(d,r,n),searchPreferences:{cabinClass:dr(s)},flightsSearchContext:{tripType:lr(i),originalBookingId:o,journeysContinuationId:u,hasCreditRedemptionIntent:"true"===l||null},travelerDetails:sr(c),sortOption:null,searchFilterValuesList:[]}}),[a.locale,a.siteId,t.search]);return n.createElement(pr.Provider,{value:i},r)}).displayName="sharedui-FlightsSearchCriteriaProvider"}}]);
//# sourceMappingURL=https://bernie-assets.s3.us-west-2.amazonaws.com/shopping-pwa/shared-ui-shopping-search-criteria-providers.36a3e30087b16c317655.js.map